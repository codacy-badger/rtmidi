git:
  depth: 1
branches:
  except:
    - /(?i:appveyor)/
sudo: false
language: c++
group: travis_latest
os:
  - osx
  - linux

compiler:
  - gcc
  - clang


addons:
  apt:
    packages:
    - autoconf
    - libtool
    - autopoint
    - automake
    - libasound-dev
    - libjack-dev
    - libcppunit-dev
    - doxygen


before_install:
    - eval "${MATRIX_EVAL}"
    - if test "$TRAVIS_OS_NAME" = osx ; then  brew update ; fi
    - if test "$TRAVIS_OS_NAME" = osx ; then if brew upgrade boost ; then echo "upgraded" ; else echo "nothing to be done"; fi ;  fi
    - if test "$TRAVIS_OS_NAME" = osx ; then rm -rf /usr/local/include/c++ ; fi # fix broken gcc installation
    - if test "$TRAVIS_OS_NAME" = osx ; then brew install $EXTRA_BREW  gettext flex bison libtool autoconf jack   doxygen ; fi
    - if test "$TRAVIS_OS_NAME" = osx ; then brew link --force $EXTRA_BREW gettext flex bison libtool autoconf jack ; fi
    - mkdir -p config
    - touch config/config.rpath

script:
    - mkdir -p config
    - touch config/config.rpath
    - autoreconf -i -f && ./configure && make -j4 && $TEST_RUNNER make check || (cat test-suite.log ; false)
    - make distcheck
    - cat tests/errors.log
